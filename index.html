<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ActuQuiz - Accueil</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; background: #f8fafc; }
        .card { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .card:hover { transform: translateY(-5px); }
        .filter-btn.active { background-color: #2563eb; color: white; border-color: #2563eb; }
    </style>
</head>
<body class="p-4 md:p-10">

    <header class="max-w-6xl mx-auto mb-10 text-center md:text-left">
        <div class="flex flex-col md:flex-row justify-between items-center gap-6">
            <div>
                <h1 class="text-5xl font-black text-slate-900 tracking-tighter italic uppercase">ActuQuiz.</h1>
                <p class="text-slate-500 font-medium text-sm mt-1">L'actualité d'Hugo Décrypte décryptée par le jeu.</p>
            </div>

            <div id="filter-bar" class="flex flex-wrap justify-center gap-3">
                </div>
        </div>
    </header>

    <main class="max-w-6xl mx-auto">
        
        <div class="mb-12">
            <a href="multiquiz.html" class="block group relative overflow-hidden bg-blue-600 rounded-[2.5rem] p-8 md:p-12 shadow-2xl shadow-blue-200 transition-all hover:scale-[1.01] active:scale-[0.99]">
                <div class="relative z-10 flex flex-col md:flex-row justify-between items-center gap-6">
                    <div class="text-center md:text-left">
                        <span class="inline-block px-3 py-1 bg-blue-500 text-white text-[10px] font-black uppercase tracking-widest rounded-full mb-4">Mode Premium</span>
                        <h2 class="text-3xl md:text-4xl font-black text-white italic uppercase tracking-tighter leading-none mb-2">Le Super Multi-Quiz.</h2>
                        <p class="text-blue-100 font-medium">Configurez votre propre session : thèmes, nombre de questions et chrono.</p>
                    </div>
                    <div class="bg-white text-blue-600 px-8 py-4 rounded-2xl font-black uppercase text-sm tracking-widest group-hover:bg-slate-900 group-hover:text-white transition-colors">
                        Lancer le défi →
                    </div>
                </div>
                <div class="absolute top-0 right-0 -mr-16 -mt-16 w-64 h-64 bg-blue-500 rounded-full opacity-20"></div>
                <div class="absolute bottom-0 left-0 -ml-10 -mb-10 w-40 h-40 bg-blue-400 rounded-full opacity-10"></div>
            </a>
        </div>

        <div class="h-px bg-slate-200 w-full mb-12"></div>

        <div id="quiz-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            </div>
    </main>

    <script>
        let allQuizzes = [];
        const themeColors = {
            'GÉOPOLITIQUE': 'bg-red-100 text-red-600 border-red-200',
            'SOCIÉTÉ': 'bg-blue-100 text-blue-600 border-blue-200',
            'ÉCONOMIE': 'bg-amber-100 text-amber-600 border-amber-200',
            'PLANÈTE': 'bg-green-100 text-green-600 border-green-200',
            'TECH': 'bg-purple-100 text-purple-600 border-purple-200',
            'CULTURE': 'bg-pink-100 text-pink-600 border-pink-200',
            'SPORT': 'bg-orange-100 text-orange-600 border-orange-200'
        };

        async function init() {
            try {
                const res = await fetch('manifest.json');
                allQuizzes = await res.json();
                allQuizzes.reverse(); // Plus récent en premier
                
                generateFilterBar();
                displayQuizzes(allQuizzes);
            } catch (e) {
                document.getElementById('quiz-grid').innerHTML = "<p class='text-center col-span-full text-slate-400'>Aucun quiz trouvé.</p>";
            }
        }

        function generateFilterBar() {
            const filterBar = document.getElementById('filter-bar');
            filterBar.innerHTML = '';

            // Bouton TOUT
            const allBtn = document.createElement('button');
            allBtn.className = "filter-btn active px-5 py-2 rounded-full border border-slate-200 text-xs font-black uppercase transition-all shadow-sm";
            allBtn.innerText = "TOUT";
            allBtn.onclick = () => filterQuiz('TOUT', allBtn);
            filterBar.appendChild(allBtn);

            // Récupérer les thèmes uniques du manifest
            const themes = [...new Set(allQuizzes.map(q => q.theme))].filter(t => t);
            
            themes.forEach(theme => {
                const btn = document.createElement('button');
                btn.className = "filter-btn px-5 py-2 rounded-full border border-slate-200 text-xs font-black bg-white text-slate-600 uppercase transition-all shadow-sm";
                btn.innerText = theme;
                btn.onclick = () => filterQuiz(theme, btn);
                filterBar.appendChild(btn);
            });
        }

        function filterQuiz(theme, clickedBtn) {
            document.querySelectorAll('.filter-btn').forEach(b => {
                b.classList.remove('active', 'bg-blue-600', 'text-white');
                b.classList.add('bg-white', 'text-slate-600');
            });
            clickedBtn.classList.add('active', 'bg-blue-600', 'text-white');
            clickedBtn.classList.remove('bg-white', 'text-slate-600');

            const filtered = theme === 'TOUT' ? allQuizzes : allQuizzes.filter(q => q.theme === theme);
            displayQuizzes(filtered);
        }

        function displayQuizzes(list) {
            const grid = document.getElementById('quiz-grid');
            grid.innerHTML = '';

            list.forEach(item => {
                const colorClass = themeColors[item.theme] || 'bg-slate-100 text-slate-600 border-slate-200';
                
                const card = document.createElement('a');
                card.href = `quiz.html?file=${item.file}`;
                card.className = "card group block bg-white rounded-[2.5rem] overflow-hidden shadow-sm border border-slate-100 hover:shadow-xl";
                
                card.innerHTML = `
                    <div class="h-52 overflow-hidden bg-slate-200">
                        <img src="${item.image}" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500" 
                             onerror="this.src='https://via.placeholder.com/600x400?text=ActuQuiz'">
                    </div>
                    <div class="p-6">
                        <div class="flex justify-between items-center mb-3">
                            <span class="px-2 py-1 rounded-md border text-[9px] font-black tracking-widest ${colorClass}">
                                ${item.theme || 'INFO'}
                            </span>
                            <span class="text-slate-300 text-[10px] font-bold uppercase tracking-tight">${item.date}</span>
                        </div>
                        <h2 class="text-xl font-black text-slate-900 leading-tight group-hover:text-blue-600 transition-colors">
                            ${item.titre}
                        </h2>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        init();
    </script>
</body>
</html>
